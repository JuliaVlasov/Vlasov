<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · VlasovSolvers.jl</title><link rel="canonical" href="https://juliavlasov.github.io/VlasovSolvers.jl/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">VlasovSolvers.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Numerical-methods"><span>Numerical methods</span></a></li><li><a class="tocitem" href="#Equations"><span>Equations</span></a></li><li><a class="tocitem" href="#Algorithm"><span>Algorithm</span></a></li><li><a class="tocitem" href="#Numerical-method-for-Poisson-equation"><span>Numerical method for Poisson equation</span></a></li></ul></li><li><a class="tocitem" href="problem/">Problem type</a></li><li><a class="tocitem" href="vlasov-poisson/">Vlasov-Poisson</a></li><li><a class="tocitem" href="vlasov-ampere/">Vlasov-Ampere</a></li><li><a class="tocitem" href="bump_on_tail/">Bump On Tail</a></li><li><a class="tocitem" href="rotation2d/">Rotation 2D</a></li><li><a class="tocitem" href="vlasov-hmf/">Vlasov-HMF</a></li><li><a class="tocitem" href="tsi/">Two-stream instability</a></li><li><a class="tocitem" href="contents/">Contents</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaVlasov/VlasovSolvers.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="VlasovSolvers.jl-Documentation"><a class="docs-heading-anchor" href="#VlasovSolvers.jl-Documentation">VlasovSolvers.jl Documentation</a><a id="VlasovSolvers.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#VlasovSolvers.jl-Documentation" title="Permalink"></a></h1><p><em>First draft of a Vlasov solvers Julia suite.</em></p><h2 id="Numerical-methods"><a class="docs-heading-anchor" href="#Numerical-methods">Numerical methods</a><a id="Numerical-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-methods" title="Permalink"></a></h2><ul><li>Backward Semi-Lagrangian</li><li>Pseudo-Spectral</li></ul><h2 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h2><p>The Vlasov equation can be split into two parts </p><p class="math-container">\[\partial_t f + v\cdot \nabla_x f=0 \;\; \mathrm{ and } \;\; \partial_t f +
E\cdot \nabla_v f=0, \]</p><p>so that the numerical solution can be approximated by the successive solution of each part of this splitting. Indeed, if we denote <span>$\varphi^x_t(f_0)$</span> the solution at time <span>$t$</span> of</p><p class="math-container">\[\partial_t f + v\cdot \nabla_x f=0, \]</p><p>and <span>$\varphi^v_t(f_0)$</span> the solution at time <span>$t$</span> of</p><p class="math-container">\[\partial_t f + E\cdot \nabla_v f=0, \]</p><p>then the solution <span>$\varphi_t(f_0)$</span> of the Vlasov equation can be approximated by</p><p class="math-container">\[\varphi_t(f_0) \approx \varphi^v_t \circ \varphi^x_t(f_0).  \]</p><p>This is the Lie-Trotter splitting which is a first order approximatoin of the solution <span>$f(t)$</span>. High  order splittings can be derived by choosing a sequence of coefficients <span>$(a_i, b_i)$</span> so that</p><p class="math-container">\[\varphi_t(f_0) \approx \Pi_{i} \;\;  \Big(\varphi^v_{a_i t} \circ \varphi^x_{b_i t}\Big)(f_0).  \]</p><p>The splitting enables to reduce the original problem into several smaller problems which are easier to solve. Indeed, in the Vlasov case, we are lead to solve one dimensional linear transport equations which we choose to solve using the semi-Lagrangian method.  The basics of the semi-Lagrangian method are recalled in the following. </p><p>We  consider the following linear transport equation </p><p class="math-container">\[\partial_t f + a \partial_x f=0, f(t=0, x) = f_0(x), x\in [0, L], \]</p><p>with periodic boundary conditions. We know that the exact solution can be written as</p><p class="math-container">\[f(t, x) = f_0(x-at), \]</p><p>or if we consider the solution from  <span>$s$</span> to <span>$t$</span>`, we have</p><p class="math-container">\[f(t, x) = f(s, x-a(t-s)).  \]</p><p>The property that <span>$f$</span> is constant along the characteristics paves the way of the semi-Lagrangian method. Indeed, let consider a time discretization <span>$t_n = n\Delta t, n\in \mathbb{N}$</span>, <span>$\Delta t&gt;0$</span> and a space discretization <span>$x_i=i\Delta x, i\in \mathbb{N}, \Delta x&gt;0, \Delta x=L/N_x$</span> where <span>$N_x$</span> is the number of points.  Considering <span>$t=t_{n+1}, s=t_n$</span> and <span>$x=x_i$</span> in the former equation, we get </p><p class="math-container">\[f(t_{n+1}, x_i) = f(t_n, x_i-a \Delta t).  \]</p><p>We assume that <span>$f(t_n, x_i)$</span> are all known, we have to compute <span>$f(t_n, x_i-a \Delta t)$</span> and this is done by a standard interpolation method. For Vlasov problem, high order interpolation are required (citer Francis, Sonnen, Michel...).  Within the framework of this package, there are two possibilities: Lagrange or B-splines interpolation (of odd degree).  Arbitrary high order is available and have been tested according to recent estimates (citer Michel-Latu-Sonnen). For <span>$p$</span> order Lagrange interpolation, we have</p><p class="math-container">\[f(t_n, x) = \sum_{i=0}^k f(t_n, x_i) L_{i,p}(x), \]</p><p>where </p><p class="math-container">\[L_{i,p}(x) = \Pi_{0\leq k\leq p, k\neq i} \frac{x-x_k}{x_i-x_k}, \;\;
\mathrm{ for } 0\leq i\leq p.  \]</p><p>For the B-spline interpolation of order <span>$p$</span>, we have</p><p class="math-container">\[f(t_n, x) = \sum_{i=0}^{N_x-1} \eta_i B_{i,p}(x) \]</p><p>where </p><p class="math-container">\[B_{i,0}(x) := \left\{
\begin{matrix}
1 &amp; \mathrm{if}  \quad t_i \leq x &lt; t_{i+1} \\
0 &amp; \mathrm{otherwise} 
\end{matrix}
\right.\]</p><p class="math-container">\[B_{i,p}(x) := \frac{x - t_i}{t_{i+p} - t_i} B_{i,p-1}(x) 
+ \frac{t_{i+p+1} - x}{t_{i+p+1} - t_{i+1}} B_{i+1,p-1}(x).\]</p><p>and the coefficients <span>$(\eta_i)_{i=0, \dots, N_x-1}$</span> are solution of a linear system to solve.</p><h2 id="Algorithm"><a class="docs-heading-anchor" href="#Algorithm">Algorithm</a><a id="Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithm" title="Permalink"></a></h2><p>Once the linear advection (or transport) equation are solved using the semi-Lagrangian method, the algorithm to solve the Vlasov-Poisson equation can be written. To do so, we consider a mesh in the truncated velocity domain <span>$[-v_{\max}, v_{\max}]$</span>: <span>$v_j = -v_{\max} + j\Delta v, j=0, \dots, N_v-1, \Delta v=2v_{\max} / N_v$</span>, <span>$N_v$</span> being the number of points in the velocity direction. The algorithm based on Lie-Trotter and semi-Lagrangian method is :</p><ol><li>Initialization. From the given initial condition <span>$f_0(x, v)$</span> we can compute the initial electric field <span>$E_0(x)$</span>. </li><li>From <span>$t_n$</span> to <span>$t_{n+1}$</span>. Knowing all the grid point values of <span>$f^n$</span> and <span>$E^n$</span></li></ol><ul><li>Compute <span>$f^\star$</span> solving</li></ul><p class="math-container">\[\partial_t f + v\partial_x f=0, \]</p><p>using the semi-Lagrangian method <span>$f^\star(x_i, v_j) = f^n(x_i-v_j\Delta t, v_j)$</span>.</p><ul><li>Solve the electric field <span>$E^\star$</span>  from the Poisson</li></ul><p>equation</p><p class="math-container">\[\partial_x E^\star = \sum_{j=0}^{N_v-1} f^\star(x_i, v_j) \Delta v -1.  \]</p><ul><li>Compute <span>$f^{n+1}$</span> solving</li></ul><p class="math-container">\[\partial_t f + E^\star\partial_v f = 0, \]</p><p>using the semi-Lagrangian method <span>$f^{n+1}(x_i, v_j) = f^n(x_i, v_j-E^\star(x_i) \Delta t)$</span>.</p><h2 id="Numerical-method-for-Poisson-equation"><a class="docs-heading-anchor" href="#Numerical-method-for-Poisson-equation">Numerical method for Poisson equation</a><a id="Numerical-method-for-Poisson-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-method-for-Poisson-equation" title="Permalink"></a></h2><p>The Poisson equation is solved using Fourier techniques. First, we consider the following DFT (Discrete Fourier Transform) of a <span>$L-$</span>periodic function <span>$g$</span> defined on a mesh of <span>$N$</span> points such that <span>$x_j=j \Delta x, \Delta x=L/N, 0\leq j\leq N-1$</span> </p><p class="math-container">\[\hat{g}_k := \frac{1}{N}\sum_{j=0}^{N-1} g(x_j) e^{-i \frac{2\pi}{L} k
x_j}, \;\; k=0, \dots, N-1. \]</p><p>Thus, from the Poisson equation,  </p><p class="math-container">\[\partial_x E = \rho -1, \]</p><p>we consider the Fourier transform to get</p><p class="math-container">\[i k \hat{E}_k = \hat{\rho}_k \;\; \mathrm{  if  } \;\;  k\neq 0, \;\;
\hat{E}_0=0.  \]</p><p>Then, we can compute the Fourier coefficients <span>$\hat{E}_k$</span> as</p><p class="math-container">\[\hat{E}_k = \frac{1}{ik}\hat{\rho}_k,  \]</p><p>and an inverse Fourier transform is used to get <span>$E_i\approx E(x_i)$</span>. </p><p>The extension of this algorithm to the multidimensional case requires to introduce the electric potential <span>$\varphi$</span> such that <span>$E=-\nabla_x \phi$</span>. The scalar electric potential solves an elliptic Poisson equation</p><p class="math-container">\[-\Delta \phi = \rho -1\]</p><p>which is also solved using Fourier techniques. Now we get (now <span>$k$</span> is a vectorial wavenumber) </p><p class="math-container">\[|k|^2 \hat{\phi}_k = \hat{\rho}_k \;\; \mathrm{  if  } \;\;  k\neq 0, \;\;
\hat{\phi}_0=0.  \]</p><p>so that <span>$\hat{\phi}_k = \hat{\rho}_k/|k|^2$</span> and the electric field can be computed using</p><p class="math-container">\[\hat{E}_k = -ik \hat{\phi}_k  \;\; \mathrm{  if  } \;\;  k\neq 0, \;\;
\hat{E}_0=0.  \]</p><p>and an inverse Fourier tranform.</p><p>Regarding the semi-Lagrangian method applied to the multidimensional advection with <span>$x\in \mathbb{R}^d$</span> and <span>$v\in \mathbb{R}^d$</span> </p><p class="math-container">\[\partial_t f + v\cdot \nabla_x f = 0 \;\; \mathrm{ or } \;\;
\partial_t f + E\cdot \nabla_v f = 0, \]</p><p>we can use the fact that these advection can be split (exactly) into one-dimensional linear transport equations. Indeed for the <span>$x$</span>-transport part we have to successively solve </p><p class="math-container">\[\partial_t f + v_\alpha\partial_{x_\alpha} f= 0, \;\; \mathrm{ for }\;\;  \alpha=1, \dots, d\]</p><p>whereas for the <span>$v$</span>-transport part we have to successively solve </p><p class="math-container">\[\partial_t f + E_\alpha\partial_{v_\alpha} f= 0, \;\; \mathrm{ for } \;\;  \alpha=1, \dots,
d. \]</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="problem/">Problem type »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 7 February 2021 20:21">Sunday 7 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
